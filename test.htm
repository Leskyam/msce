
<!doctype html public "-//w3c//dtd html 4.0 transitional//en" >
<html>
	<head>
		<title>Maestría: Mi maletín</title>
		<meta content="False" name="vs_showGrid">
		<meta content="Microsoft Visual Studio .NET 7.1" name="GENERATOR">
		<meta content="C#" name="CODE_LANGUAGE">
		<meta content="JavaScript" name="vs_defaultClientScript">
		<meta content="http://schemas.microsoft.com/intellisense/ie5" name="vs_targetSchema">
		<link href="estilos/main.css" type="text/css" rel="stylesheet">
		<link rel="shortcut icon" href="imagenes/favicon.ico">
		<!-- Cargar el fichero principal de scripts del lado del cliente -->
		<script src="includes/main.js" type="text/javascript"></script>
		<script src="includes/dates.js" type="text/javascript"></script>
	</head>
	<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0"> <!-- PAGE TABLE; BEGIN -->
		<form name="frm_MiMaletin" method="post" action="mi_maletin.aspx" id="frm_MiMaletin" enctype="multipart/form-data">
<input type="hidden" name="__VIEWSTATE" value="dDwtNzY2NjQ4MzczO3Q8O2w8aTwxPjs+O2w8dDw7bDxpPDE+Oz47bDx0PDtsPGk8MT47aTwzPjtpPDU+O2k8Nz47PjtsPHQ8cDxsPGlubmVyaHRtbDs+O2w8Q2llbmZ1ZWdvczs+Pjs7Pjt0PHA8bDxpbm5lcmh0bWw7PjtsPEhvc3BlZGVybzogVW5pdmVyc2lkYWQgUGVkYWcmIzI0M1w7Z2ljYSBkZSBDaWVuZnVlZ29zOz4+Ozs+O3Q8cDxsPFZpc2libGU7PjtsPG88Zj47Pj47Oz47dDw7bDxpPDE+O2k8Mz47PjtsPHQ8cDxsPGlubmVyaHRtbDs+O2w8TWFlc3RyYW50ZTs+Pjs7Pjt0PHA8bDxpbm5lcmh0bWw7PjtsPFVzdWFyaW8gTSBBcGVsbGlkb3MgZGVsIE1hZXN0cmFudGU7Pj47Oz47Pj47Pj47Pj47Pj47bDxjdGxIZWFkZXI6aW1nTG9nb3V0Oz4+hPhUSmd7Kum2TiFGjNjFfEpeg2c=" ID="Hidden1"/>
	
<script type="text/javascript" src="/msce/ajaxpro/prototype.ashx"></script>
<script type="text/javascript" src="/msce/ajaxpro/core.ashx"></script>
<script type="text/javascript" src="/msce/ajaxpro/converter.ashx"></script>
<script type="text/javascript" src="/msce/ajaxpro/ISPCFG.Msce.clswfMiMaletin,ISPCFG.Msce.ashx"></script>
<script type="text/javascript" src="/msce/ajaxpro/ISPCFG.Msce.wucHeader,ISPCFG.Msce.ashx"></script>
<script type="text/javascript" src="/msce/ajaxpro/ISPCFG.Msce.wucLeftOptions,ISPCFG.Msce.ashx"></script>


	
<script language="javascript" type="text/javascript" src="includes/C1WebCommand/c1menu.js"></script>


			<table cellspacing="0" cellpadding="0" width="750" align="center" border="0" ID="Table1">
				<tr>
					<td><!-- CONTROL PARA EL ENCABEZADO, QUE INCLUYE LOS CONTROLES PARA IDENTIFICACIÓN DE USUARIO -->

<!-- HEADER TABLE; BEGIN -->
<table cellspacing="0" cellpadding="0" width="750" align="center" border="0" ID="Table2">
	<tr valign="top">
		<td>
			<table cellspacing="0" cellpadding="0" width="750" border="0" ID="Table3">
				<tr valign="top">
					<td>
						<table cellspacing="0" cellpadding="0" width="750" border="0" ID="Table4">
							<tr>
								<td><!-- Imagen para el logo de la maestría --><img alt="" src="imagenes/header_logo1.gif"></td>
								<td valign="middle" align="center" width="545" background="imagenes/header_image_1.gif" colspan="2" height="104">
									<!-- Parte superior del globo terráqueo que se encuentra a la derecha -->
									<table border="0" width="545" ID="Table5">
										<tr height="84">
											<td valign="middle" align="center" width="545"><span class="tit_Aplicacion_B">MAESTRÍA <font color="#47639a">
														A DISTANCIA</font></span><br><span id="ctlHeader_spProvinciaNombre" class="subtit_A">Cienfuegos</span>
											</td></tr>
										<tr valign="bottom"><td align="right" style="PADDING-RIGHT: 2px; PADDING-BOTTOM: 1px"><b><span id="ctlHeader_spHospedero" class="tinytext_A">Hospedero: Universidad Pedag&#243;gica de Cienfuegos</span></b></td></tr>
									</table>

								</td>
							</tr>
							<tr>
								<td valign="top"><!-- imagen en la parte inferior al logo --><img height="38" alt="" src="imagenes/header_logo2.gif" width="205"></td>
								<td valign="top"><img height="38" alt="" src="imagenes/header_members.gif"></td>
								<td valign="top" background="imagenes/header_members_bg.gif"><img height="1" alt="" src="imagenes/spacer.gif" width="397"><br>
									<!-- PARTE QUE LE CORRESPONDE A LOS CONTROLES PARA AUTENTICACIÓN -->
									<!-- DIV PARA CUANDO EL USUARIO NO ESTÁ IDENTIFICADO -->
									
									<!-- DIV PARA CUANDO EL USUARIO ESTÁ IDENTIFICADO -->
									<div id="ctlHeader_dvWelcome">
										<table id="tbl_Welcome" cellspacing="0" cellpadding="0" width="397" border="0">
											<tr valign="middle" height="17">
												<td width="5" rowspan="2"><img alt="" src="imagenes/spacer.gif" width="5" height="30"> </td>
												<td valign="bottom" align="left" width="246"><span id="ctlHeader_spUserRoles" class="textRoleName_B" style="WIDTH: 100%">Maestrante</span></td>
												<td align="right" colspan="4"><span class="tinytext" id="spSessionTimeout" title="Tiempo para que finalice la sesión automáticamente.">Tiempo:</span> </td>
												<td rowspan="2"><img alt="" src="imagenes/spacer.gif" width="10" height="30"> </td></tr>
											<tr valign="middle" height="20">
												<td valign="middle" align="left" width="246"><span id="ctlHeader_spUserFullName" class="textUserFullName_B" style="WIDTH: 100%">Usuario M Apellidos del Maestrante</span></td>
												<td width="16" rowspan="1" style="WIDTH: 16px"><img alt="" src="imagenes/spacer.gif" width="15" height="18"> </td>
												<td align="right" width="65"><a href="perfil.aspx"><img id="imgViewProfile" title="Ver/modificar datos de mi perfil." height="18" alt="Mi perfil" src="imagenes/btn_my_profile.gif" border="0" name="imgViewProfile"></a> </td>
												<td width="10"><img alt="" src="imagenes/spacer.gif" width="10" height="18"> </td>
												<td align="left" width="46"><input type="image" name="ctlHeader:imgLogout" id="ctlHeader_imgLogout" src="imagenes/btn_logout.gif" alt="Salir" border="0" /></td></tr></table></div></td></tr></table></td></tr></table></td></tr></table>
<!-- HEADER TABLE; END -->

<!-- -->
<script language="JavaScript">
<!-- Evitar que sea leído por navegadores que no soporten JavaScript.

function ForceToCloseSession()
{
	ISPCFG.Msce.wucHeader.ForceToCloseSession(ForceToCloseSession_CallBlack);
}

function ForceToCloseSession_CallBlack(res)
{
	if(res.value!='' & res.error==null){window.open(document.location.protocol + '//' + document.domain + res.value + '/index.aspx',"_self",null,false);}
	res = null;
	return;
}

//if(document.getElementById('ctlHeader_dvLogin')!=null){alert('ok');document.getElementById('ctlHeader_txtUserId').focus();}

// Terminar de ocultar el código JavaScript -->
</script>

</td>
				</tr>
				<tr>
					<td><!-- CONTROL PARA LA BARRA DE OPCIONES DEL ENCABEZADO -->
<!-- TABAL PARA EJEMPLO DE LAS OPCIONES DEL DIRECTOR DE LA MAESTRÍA -->
<table cellspacing="0" cellpadding="0" width="750" align="center" border="0" ID="Table6">
	<tr valign="top">
		<td>
			<table cellspacing="0" cellpadding="0" width="205" align="left" border="0" ID="Table7">
				<tr>
					<td><img height="22" alt="" src="imagenes/header_bar_left.gif" width="21"></td>
					<td><a title="Portal" href="/"><img height="22" alt="Portal" src="imagenes/header_button_home.gif" width="184" border="0"></a></td>
				</tr>
			</table>
		</td>
		<td>
			<table id="tbl_HeaderOptions" cellspacing="0" cellpadding="0" width="545" align="right"
				bgcolor="#415884" border="0">
				<tr height="1">
					<td valign="top" bgcolor="#ffffff"></td>
				</tr>
				<tr height="20">
					<td id="td_HeaderOptions" style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; FONT-SIZE: 8pt; COLOR: #ffffff; FONT-FAMILY: Verdana"
						align="center">
						<!-- Espacio para el contenido de las opciones o de las frases. --><div style="position:absolute;visibility:hidden;left:0px;top:0px;"><img width="0" height="0" alt="C1WEBCOMMANDIMGPRELOAD"/>
<img width="0" height="0" alt="" src="/msce/imagenes/webmnu_separator.gif"/>
<img width="0" height="0" alt="" src="/msce/imagenes/webmnu_down.gif"/>
</div><table ID="ctlHeaderNavBar_webmnu_header_options" c1_horz="true" cellspacing="0" cellpadding="0" style="color:White;font-size:8pt;font-family:Verdana;padding:0px;z-index:;left:;top:;position:" c1_item_styles="color:White;backgroundColor:#415884;borderColor:#415884;borderStyle:Solid;borderWidth:1px;" c1_sel_item_styles="color:White;backgroundColor:#748BB7;borderColor:#E0E0E0;"><tr><td valign="top"><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" style="float:left;" ID="Table8"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" ID="ctlHeaderNavBar_mnuInicio" TITLE="Inicio de la aplicación." style="position:static;float:left;padding:1px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;height:100%;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="window.open('/msce/index.aspx','_self');" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><span style="width:3px"></span></TD><TD align="left" ID="item_text">Inicio</TD><TD style="text-decoration:none;">&nbsp;</TD></TABLE></td></tr></table><IMG SRC="/msce/imagenes/webmnu_separator.gif" style="float:left;"  ID="ctlHeaderNavBar_mnu_separator01"><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" style="float:left;" ID="Table9"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" ID="ctlHeaderNavBar_mnuBibliografia" c1_submenu_id="ctlHeaderNavBar_C1SubMenuBibliografia" c1_submenu_open="over" c1_img_src="/msce/imagenes/webmnu_down.gif" c1_img_sel_src="" style="position:static;float:left;padding:1px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;height:100%;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="c1c_onclick(event,this);" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><IMG src="/msce/imagenes/webmnu_down.gif"></TD><TD align="left" ID="item_text">Bibliografía</TD><TD style="text-decoration:none;">&nbsp;</TD></TABLE></td></tr></table><IMG SRC="/msce/imagenes/webmnu_separator.gif" style="float:left;"  ID="ctlHeaderNavBar_mnu_separator04"><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" style="float:left;" ID="Table10"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" ID="ctlHeaderNavBar_mnuConsultas" c1_submenu_id="ctlHeaderNavBar_C1SubMenuConsultas" c1_submenu_open="over" c1_img_src="/msce/imagenes/webmnu_down.gif" c1_img_sel_src="" style="position:static;float:left;padding:1px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;height:100%;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="c1c_onclick(event,this);" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><IMG src="/msce/imagenes/webmnu_down.gif"></TD><TD align="left" ID="item_text">Consultas</TD><TD style="text-decoration:none;">&nbsp;</TD></TABLE></td></tr></table><IMG SRC="/msce/imagenes/webmnu_separator.gif" style="float:left;"  ID="ctlHeaderNavBar_mnu_separator05"><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" style="float:left;" ID="Table11"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" ID="ctlHeaderNavBar_mnuEncuentros" TITLE="Ver encuentros presenciales planificados." style="position:static;float:left;padding:1px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;height:100%;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="window.open('ver_encuentros.aspx','_self');" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><span style="width:3px"></span></TD><TD align="left" ID="item_text">Encuentros</TD><TD style="text-decoration:none;">&nbsp;</TD></TABLE></td></tr></table><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" style="float:left;" ID="Table12"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" ID="ctlHeaderNavBar_mnuMiproyecto" style="position:static;float:left;padding:1px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;height:100%;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="window.open('solicitar_tema_proyecto.aspx','_self');" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><span style="width:3px"></span></TD><TD align="left" ID="item_text">Mi proyecto</TD><TD style="text-decoration:none;">&nbsp;</TD></TABLE></td></tr></table></table><table ID="ctlHeaderNavBar_C1SubMenuMaestria" cellspacing="0" cellpadding="0" onmouseout="c1c_onmouseout_submenu(event,this);" style="color:White;font-size:8pt;font-family:Verdana;padding:2px;visibility:hidden;left:0px;top:0px;position:absolute" c1_item_styles="color:White;backgroundColor:#415884;borderColor:#415884;borderStyle:Solid;borderWidth:1px;" c1_sel_item_styles="color:White;backgroundColor:#748BB7;borderColor:#E0E0E0;"><tr><td valign="top"></table><table ID="ctlHeaderNavBar_C1SubMenuPersonal" cellspacing="0" cellpadding="0" onmouseout="c1c_onmouseout_submenu(event,this);" style="color:White;font-size:8pt;font-family:Verdana;padding:2px;visibility:hidden;left:0px;top:0px;position:absolute" c1_item_styles="color:White;backgroundColor:#415884;borderColor:#415884;borderStyle:Solid;borderWidth:1px;" c1_sel_item_styles="color:White;backgroundColor:#748BB7;borderColor:#E0E0E0;"><tr><td valign="top"></table><table ID="ctlHeaderNavBar_C1SubMenuBibliografia" cellspacing="0" cellpadding="0" onmouseout="c1c_onmouseout_submenu(event,this);" style="color:White;font-size:8pt;font-family:Verdana;padding:2px;visibility:hidden;left:0px;top:0px;position:absolute" c1_item_styles="color:White;backgroundColor:#415884;borderColor:#415884;borderStyle:Solid;borderWidth:1px;" c1_sel_item_styles="color:White;backgroundColor:#748BB7;borderColor:#E0E0E0;"><tr><td valign="top"><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" width="100%" ID="Table13"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" width="100%" ID="ctlHeaderNavBar_smnuBuscarBibliografia" TITLE="Buscar y descargar bibliografía." style="position:static;padding:2px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="window.open('buscador_bibliografias.aspx','_self');" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><span style="width:3px"></span></TD><TD align="left" ID="item_text">Buscar y descargar</TD><TD><span style="width:1em">&nbsp;</span></TD></TABLE></td></tr></table></table><table ID="ctlHeaderNavBar_C1SubMenuConsultas" cellspacing="0" cellpadding="0" onmouseout="c1c_onmouseout_submenu(event,this);" style="color:White;font-size:8pt;font-family:Verdana;padding:2px;visibility:hidden;left:0px;top:0px;position:absolute" c1_item_styles="color:White;backgroundColor:#415884;borderColor:#415884;borderStyle:Solid;borderWidth:1px;" c1_sel_item_styles="color:White;backgroundColor:#748BB7;borderColor:#E0E0E0;"><tr><td valign="top"><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" width="100%" ID="Table14"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" width="100%" ID="ctlHeaderNavBar_smnuConsultar" TITLE="Registrar nuevas consultas." style="position:static;padding:2px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="window.open('consultar.aspx','_self');" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><span style="width:3px"></span></TD><TD align="left" ID="item_text">Consultar</TD><TD><span style="width:1em">&nbsp;</span></TD></TABLE></td></tr></table><TABLE cellspacing="0" cellpadding="0" c1_freeztext="yes" width="100%" ID="Table15"><tr><td style="padding:0px;"><TABLE cellpadding="0" cellspacing="0" width="100%" ID="ctlHeaderNavBar_smnuBuscarConsultas" TITLE="Buscar consultas." style="position:static;padding:2px;background-color:#415884;color:White;font-size:8pt;font-family:Verdana;border-width:1px;border-style:solid;border-color:#415884;cursor:pointer;cursor:hand;" onmouseout="if (!c1c_mnu_check_mouse_out(event, this)) return false;c1c_onmouseout(event,this);" onmouseover="c1c_onmouseover(event,this);" onclick="window.open('buscador_consultas.aspx','_self');" onfocus="if (event.altKey) this.click();"><TR><TD align="left" style="width:3px;"><span style="width:3px"></span></TD><TD align="left" ID="item_text">Buscar consultas</TD><TD><span style="width:1em">&nbsp;</span></TD></TABLE></td></tr></table></table></td>
				</tr>
				<tr height="1">
					<td valign="top" bgcolor="#ffffff"></td>
				</tr>
			</table>
		</td>
	</tr>
</table>
</td>
				</tr>
			</table>
			<table id="Table16" cellspacing="0" cellpadding="0" width="750" align="center" border="0">
				<tr id="tr_Notify" style="DISPLAY: none" height="0">
	<td width="750"><span id="sp_Notify" class="spErrorNotification" style="MARGIN-BOTTOM: 1px"></span></td>
</tr>

				<tr valign="top">
					<td> <!-- BODY TABLE; BEGIN -->
						<table id="Table17" cellspacing="0" cellpadding="0" width="750" border="0">
							<tr valign="top">
								<td valign="top" align="right">
									<!-- Control Web para las opciones de la izquierda -->

<script language="javascript">
<!--
function TextDecoration(obj)
{
	
	if(obj.style.textDecoration == 'underline')
	{
		//obj.style.backgroundColor = 'transparent';
		obj.style.textDecoration = 'none';
	}
	else
	{
		//obj.style.backgroundColor = '#f0f8ff';
		obj.style.textDecoration = 'underline';
	}
	return;
}

function ShowHideOptions(imgName, dvName)
{
	var oImg = document.getElementById(imgName);
	var oDiv = document.getElementById(dvName);
	
	if(oDiv.style.display==''){oDiv.style.display = 'block';}
	
	if(oDiv.style.display != 'block')
	{	
		oImg.src = 'imagenes/minus.gif';
		oDiv.style.display = 'block';
	}
	else
	{
		oImg.src = 'imagenes/plus.gif';
		oDiv.style.display = 'none';
	}
	
	return;
}

//-->
</script>

<table id="tbl_navBarLeft" cellspacing="0" cellpadding="0" width="205" border="0">
	<tr>
		<td background="imagenes/search_bg.gif">
			<table id="tbl_Patrocinan" cellspacing="0" cellpadding="0" border="0" height="65">
				<tr valign="middle">
					<td>
						<img alt="" src="imagenes/spacer.gif" width="5">
					</td>
					<td class="tinytext" valign="middle" align="left" width="100">
						Auspicia
						<a href="http://www.iplac.rimed.cu/" title="Instituto Pedagógico Latinoamericano y Caribeño." target="_blank"><img src="imagenes/logo_iplac.gif" alt="IPLAC" title="Instituto Pedagógico Latinoamericano y Caribeño." border="0"></a>
					</td>
					<td class="tinytext" valign="middle" align="left" width="100">
						Rectorea
						<img src="imagenes/logo_cep.gif" alt="CEP" title="Centro de Estudios Pedagógicos." border="0">
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td id="td_navBarLeft" style="PADDING-RIGHT: 3px; PADDING-LEFT: 3px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px" valign="top" align="left" width="205" height="320">
			<!-- Opcionens a la izquierda -->
			<!-- TABLA PARA LA ENVOLTURA DE LAS TABLAS DE LAS OPCIONES -->
			<table width="100%" border="0" align="left" cellpadding="0" cellspacing="0" ID="Table18">
				<tr>
					<td>
						<!-- OPCIONES: Académicos (Nacionales y Provinciales) -->
						<div id="dvWrapperAcademicos" class="dvLeftOptionWrapper">
							<div class="dvLeftOptionHeader" onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" onclick="JavaScript:ShowHideOptions('img01','dvAcademicos');"><img id="img01" src="imagenes/plus.gif" border="0">&nbsp;Comités
								de académicos</div>
							<div id="dvAcademicos" class="dvLeftOptionContent" style="DISPLAY: none">
								<span onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);"><a href="http://www.iplac.rimed.cu" target="_blank">Nacional</a></span><br>
								<span onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);">
									<a href="lista_usuarios.aspx?role=academico" target="_self">Provincial</a></span>
							</div>
						</div>
						<!-- 
						OPCIONES: Recordatorios (Solicitudes de registro, Solicitudes de tema de proy.
											Consultas por responder, Respuestas a consultas, 
											Mensajes no leídos). 
						-->
						<div id="dvWrapperRecordatorios" class="dvLeftOptionWrapper">
							<div class="dvLeftOptionHeader" onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" onclick="JavaScript:ShowHideOptions('img02','dvRecordatorios');"><img id="img02" src="imagenes/minus.gif" border="0">&nbsp;Recordatorios</div>
							<div id="dvRecordatorios" class="dvLeftOptionContent">
								<div id="dvRegistroPendiente" title="Solicitudes de registro de Maestrante." onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" style="display: none;">
									Solicitudes de registro
								</div>
								<div id="dvTemaProyectoPendiente" title="Maestrantes solicitando temas de proyecto." onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" style="display: none;">
									Solicitando tema de proy.
								</div>
								<div id="dvConsultasSinRespuesta" title="Consultas dirigidas a usted, que no han sido respondidas." onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" style="display: none;">
									Consultas por responder
								</div>
								<div id="dvConsultasRespondidas" title="Consultas respondidas que han sido leídas." onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" style="display: none;">
									Consultas respondidas
								</div>
								<div id="dvMensajesSinLeer" title="Mensajes sin leer." onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" onclick="JavaScript:ShowMessageViewer(this);">
									Mensajes sin leer
								</div>
							</div>
						</div>
						<!-- OPCIONES: Buscadores (Personas, consultas, bibliografía) -->
						<div id="dvWrapperBuscadores" class="dvLeftOptionWrapper">
							<div class="dvLeftOptionHeader" onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" onclick="JavaScript:ShowHideOptions('img03','dvBuscadores');"><img id="img03" src="imagenes/plus.gif" border="0">
								Buscadores
							</div>
							<div id="dvBuscadores" class="dvLeftOptionContent" style="DISPLAY: none">
								<span id="spSearchBibliografias" style="DISPLAY: none" onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);"><a href="buscador_bibliografias.aspx" target="_self">Bibliografías</a></span>
								<span id="spSearchConsultas" style="DISPLAY: none" onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);"><a href="buscador_consultas.aspx" target="_self">Consultas</a></span>
								<span id="spSearchUsuarios" style="DISPLAY: block" onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);"><a href="buscador_usuarios.aspx" target="_self">Usuarios</a></span>
							</div>
						</div>
						<!-- OPCIONES: Usuarios identificados (Lista de usuarios identificados) -->
						<div id="dvWrapperUsuariosIdentificados" class="dvLeftOptionWrapper">
							<div id="dvUsuariosIdentificadosHeader" class="dvLeftOptionHeader" onmouseover="JavaScript:TextDecoration(this);" onmouseout="JavaScript:TextDecoration(this);" onclick="JavaScript:if(document.getElementById('spUsuariosIdentificados').innerHTML!=''){ShowHideOptions('img04','spUsuariosIdentificados')};"><img id="img04" src="imagenes/minus.gif" border="0">&nbsp;Usuarios
								identificados</div>
							<span id="spUsuariosIdentificados" class="spLeftOptionContent" style="DISPLAY: none">
							</span>
						</div>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr>
		<td style="PADDING-RIGHT: 5px; PADDING-LEFT: 5px; PADDING-BOTTOM: 2px; PADDING-TOP: 2px" valign="top" align="left" width="205">
		</td>
	</tr>
</table>

<!-- EDITOR PARA MENSAJES -->
<div id="dvMessageEditor" style="DISPLAY: none; FONT-WEIGHT: normal; FONT-SIZE: 7pt; Z-INDEX: 1; WIDTH: 200px; COLOR: black; FONT-FAMILY: Verdana; POSITION: absolute">
	<div id="dvMessageEditorHeader" style="BORDER-RIGHT: #47639a 1px solid; PADDING-RIGHT: 1px; BORDER-TOP: #47639a 1px solid; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; BORDER-LEFT: #47639a 1px solid; WIDTH: 100%; PADDING-TOP: 1px; BORDER-BOTTOM: #47639a 1px solid; HEIGHT: 16px; BACKGROUND-COLOR: #ffffe0; TEXT-ALIGN: left">
		A:
	</div>
	<div id="dvMessageEditorBody" style="BORDER-RIGHT: #47639a 1px solid; PADDING-RIGHT: 1px; BORDER-TOP: #47639a 1px solid; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; BORDER-LEFT: #47639a 1px solid; WIDTH: 100%; PADDING-TOP: 1px; BORDER-BOTTOM: #47639a 1px solid; HEIGHT: 55px; BACKGROUND-COLOR: #ffffff">
		<textarea id="txtMessageContent" style="PADDING-RIGHT: 2px; PADDING-LEFT: 2px; FONT-WEIGHT: normal; FONT-SIZE: 7pt; PADDING-BOTTOM: 2px; OVERFLOW: auto; WIDTH: 100%; COLOR: black; BORDER-TOP-STYLE: none; PADDING-TOP: 2px; FONT-FAMILY: Verdana; BORDER-RIGHT-STYLE: none; BORDER-LEFT-STYLE: none; POSITION: static; HEIGHT: 100%; BACKGROUND-COLOR: #f0f8ff; BORDER-BOTTOM-STYLE: none" onkeyup="JavaScript:document.getElementById('spCaracteresRestantes').innerHTML='Caracteres restantes: ' + getInputCharLeft(this, 100);" onkeydown="JavaScript:document.getElementById('spCaracteresRestantes').innerHTML='Caracteres restantes: ' + getInputCharLeft(this, 100);" NAME="txtMessageContent"></textarea>
	</div>
	<div id="dvMessageEditorFoot" style="BORDER-RIGHT: #47639a 1px solid; PADDING-RIGHT: 1px; BORDER-TOP: #47639a 1px solid; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; BORDER-LEFT: #47639a 1px solid; WIDTH: 100%; PADDING-TOP: 1px; BORDER-BOTTOM: #47639a 1px solid; HEIGHT: 30px; BACKGROUND-COLOR: #ffffe0">
		<span style="DISPLAY: block; WIDTH: 100%; TEXT-ALIGN: left" id="spCaracteresRestantes">Caracteres
			restantes: 100</span>
		<span style="DISPLAY: block; WIDTH: 100%; TEXT-ALIGN: right"><a id="lnkSendMessage" name="lnkSendMessage" style="COLOR: #072660; TEXT-DECORATION: underline" href="JavaScript:SendMessage();">Enviar</a>&nbsp;<a style="COLOR: #072660; TEXT-DECORATION: underline" href="JavaScript:HideMessageEditor();">Cancelar</a>&nbsp;
		</span>
	</div>
</div>
<!-- FIN DEL EDITOR PARA MENSAJES -->

<!-- VISOR DE MENSAJES -->
<div id="dvMessageViewer" style="DISPLAY: none; FONT-WEIGHT: normal; FONT-SIZE: 7pt; Z-INDEX: 1; WIDTH: 200px; COLOR: black; FONT-FAMILY: Verdana; POSITION: absolute">
	<div id="dvMessageViewerHeader" style="BORDER-RIGHT: #47639a 1px solid; PADDING-RIGHT: 1px; BORDER-TOP: #47639a 1px solid; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; BORDER-LEFT: #47639a 1px solid; WIDTH: 100%; PADDING-TOP: 1px; BORDER-BOTTOM: #47639a 1px solid; BACKGROUND-COLOR: #ffffe0; TEXT-ALIGN: left">
		De:
	</div>
	<div id="dvMessageViewerBody" style="BORDER-RIGHT: #47639a 1px solid; PADDING-RIGHT: 1px; BORDER-TOP: #47639a 1px solid; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; BORDER-LEFT: #47639a 1px solid; WIDTH: 100%; PADDING-TOP: 1px; BORDER-BOTTOM: #47639a 1px solid; HEIGHT: 55px; BACKGROUND-COLOR: #f0f8ff; TEXT-ALIGN: justify">
	</div>
	<div id="dvMessageViewerFoot" style="BORDER-RIGHT: #47639a 1px solid; PADDING-RIGHT: 1px; BORDER-TOP: #47639a 1px solid; PADDING-LEFT: 1px; PADDING-BOTTOM: 1px; BORDER-LEFT: #47639a 1px solid; WIDTH: 100%; PADDING-TOP: 1px; BORDER-BOTTOM: #47639a 1px solid; BACKGROUND-COLOR: #ffffe0">
		<span style="DISPLAY: block; WIDTH: 100%; TEXT-ALIGN: right"><a id="lnkNext" name="lnkNext" style="COLOR: #072660; TEXT-DECORATION: underline" href="JavaScript:getNextMessage();">Siguiente</a>&nbsp;<a style="COLOR: #072660; TEXT-DECORATION: underline" href="JavaScript:HideMessageViewer();">Cerrar</a>&nbsp;
		</span>
	</div>
</div>
<!-- FIN DEL VISOR DE MENSAJES -->

<script language="javascript">
<!--

/*
	MUESTRA Y SITÚA EL EDITOR PARA MENSAJES EN LA
	POSICIÓN CORRECTA SEGÚN EL ID DE USUARIO SOBRE
	EL QUE SE HAGA CLICK.
*/
function ShowMessageEditor(sender, userNombreCompleto)
{
	var topExtra;
	var leftExtra;
	var parentSender;
	var editorHeight;
	
	// Elemento DIV (envoltura del editor)
	objMessageEditor = document.getElementById('dvMessageEditor');
	// Elemento textArea
	textAreaContent = document.getElementById('txtMessageContent');
	// Elemento DIV (header del editor)
	editorHeader = document.getElementById('dvMessageEditorHeader')
	// Elemento <A> para enviar mensaje.
	objLinkSendMessage = document.getElementById('lnkSendMessage');

	if(msie)
	{
		parentSender = sender.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
		topExtra = 235;
		editorHeight = 50;
	}
	else
	{
		parentSender = sender.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
		topExtra = 230;
		editorHeight = 50;
	}
	
	leftExtra = 205;
	var leftPos = parentSender.offsetLeft + leftExtra;
	var topPos = sender.offsetTop + topExtra;
	
	// Reestablecer la cantidad de caracteres restantes para escribir, según como sea el valor de 'textAreaContent'.
	document.getElementById('spCaracteresRestantes').innerHTML='Caracteres restantes: ' + getInputCharLeft(textAreaContent, 100);
	
	objMessageEditor.style.left = leftPos;
	objMessageEditor.style.top = topPos;
	objMessageEditor.style.height = editorHeight;
	objMessageEditor.style.display = 'block';
	
	// Limpiar el contenido del textArea si el usuario al que se está escribiendo no es el mismo.
	if(editorHeader.innerHTML.indexOf(userNombreCompleto)<0){textAreaContent.value = '';}
	editorHeader.innerHTML = 'A: <a href="perfil.aspx?Id=' + sender.id + '" title="Ver perfil">' + userNombreCompleto + '</a>';
	// Establecer el href del link para envío de mensaje.
	objLinkSendMessage.href = "JavaScript:SendMessage('" + sender.id + "');";
	// Establecer el enfoque al textArea.
	textAreaContent.focus();
		
} // Fin de ShowMessageEditor()

/*
	MUESTRA Y SITÚA EL VISOR PARA MENSAJES EN LA
	POSICIÓN CORRECTA SEGÚN LA POSICIÓN DEL VÍNCULO
	CON NOMBRE "Mensajes sin leer (x)".
*/
function ShowMessageViewer(sender)
{
	var topExtra;
	var leftExtra;
	var parentSender;
	var viewerHeight;
	
	// Elemento DIV (envoltura del visor de mensajes)
	divMessageViewer = document.getElementById('dvMessageViewer');
	// Elemento DIV (header del visor)
	divMessageViewerHeader = document.getElementById('dvMessageViewerHeader')
	// Elemento <div> para el contenido del mensaje.
	divMessageViewerBody = document.getElementById('dvMessageViewerBody');
	// Elemento <A> para ver el siguiente mensaje.
	LinkNext = document.getElementById('lnkNext');

	if(msie)
	{
		parentSender = sender.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
		topExtra = 235;
		viewerHeight = 50;
	}
	else
	{
		parentSender = sender.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode;
		topExtra = 230;
		viewerHeight = 50;
	}
	
	leftExtra = 205;
	var leftPos = parentSender.offsetLeft + leftExtra;
	var topPos = sender.offsetTop + topExtra;
	
	divMessageViewer.style.left = leftPos; //sender.offsetLeft; // + sender.width; // eTABLE.offsetLeft + eSrc.width;
	divMessageViewer.style.top = topPos; // eTABLE.offsetTop + eTR.offsetTop;
	divMessageViewer.style.height = viewerHeight;
	divMessageViewer.style.display = 'block';
	
	getNextMessage();
		
} // Fin de ShowMessageEditor()

// Mostrar mensajes de advertencia de que no hay más mensajes.
function WarningNoMoreMessage()
{
			// Elemento DIV (header del visor)
			divMessageViewerHeader.innerHTML = "NO TIENE MENSJES";
			// Elemento <div> para el contenido del mensaje.
			document.getElementById('dvMessageViewerBody').innerHTML = "No existen mensajes para usted.";
			// Ocultar el vínculo al mensaje siguiente.
			document.getElementById('lnkNext').style.display='none';
}

function HideMessageEditor()
{
	textAreaContent = document.getElementById('txtMessageContent');
	// Limpiar el mensaje de envío satisfactorio al cerrar y el de error.
	if(textAreaContent.value=='Mensaje enviado correctamente.' || textAreaContent.value.indexOf('Ha ocurrido un error')>-1)
	{
		textAreaContent.value = '';		
	}
	// Ocultar el editor de mensajes.
	document.getElementById('dvMessageEditor').style.display='none';
} // Fin de HideMessageEditor()


function HideMessageViewer()
{
	document.getElementById('dvMessageViewer').style.display='none';
	document.getElementById('dvMessageViewerBody').innerHTML ='';
} // Fin de HideMessageViewer()

/*
	FUNCIONES PARA PROCEDIMIENTOS AJAX.
*/

// Actualizar la lista de usuarios identificados.
function getUsersList()
{
	//document.getElementById('spUsuariosIdentificados').innerHTML = "Cargando...";
	ISPCFG.Msce.wucLeftOptions.getUsersList(getUsersList_CallBack);
	window.setTimeout('getUsersList()', 60000); // 60000 es el valor correcto.
} // Fin de getUsersList()

function getUsersList_CallBack(res)
{
	var spListaUsuarios = document.getElementById('spUsuariosIdentificados');
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{
			boError = true;
		}
	}
	if(boError)
	{
		spListaUsuarios.innerHTML = "<span>" + MSG_ERROR_BEGTAG + "Error" + MSG_ENDTAG + "</span>";
		res = null;
		return;
	}
	if(res.value=='')
	{
		spListaUsuarios.style.display='none';
	}
	else
	{
		spListaUsuarios.style.display='block';
		document.getElementById('img04').src = 'imagenes/minus.gif';
	}
	spListaUsuarios.innerHTML = res.value;
	res = null;
	return;

} // Fin de getUsersList_CallBack()


function getCantLoggedUsers()
{
	ISPCFG.Msce.wucLeftOptions.getCantLoggedUsers(getCantLoggedUsers_CallBack);
	window.setTimeout('getCantLoggedUsers()', 60000); // 60000 es el valor correcto.
} // Fin de getCantUsersLogged()

function getCantLoggedUsers_CallBack(res)
{
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{	
			boError = true;
		}
	}
	if(boError)
	{
		document.getElementById('dvUsuariosIdentificadosHeader').innerHTML = "<img id=\"img04\" src=\"imagenes/minus.gif\" border=\"0\">&nbsp;Usuarios identificados (" + MSG_ERROR_BEGTAG + "Error" + MSG_ENDTAG + ")";
		res = null;
		return;
	}
	document.getElementById('dvUsuariosIdentificadosHeader').innerHTML = '<img id="img04" src="imagenes/minus.gif" border="0">&nbsp;Usuarios identificados (' + res.value + ')';
	res = null;

} // Fin de getCantUsersLogged_CallBack()

// Enviar mensaje a otro usuario.
function SendMessage(userTo)
{
	// Elemento textArea
	textAreaContent = document.getElementById('txtMessageContent');
	if(textAreaContent.value=='')
	{
		textAreaContent.value = 'ADVERTENCIA:\nTeclee aquí el contenido del mensaje.';
		return;
	}
	var msgData = userTo + '|' + textAreaContent.value;
	textAreaContent.value = 'Enviando mensaje. Por favor, espere...';
	ISPCFG.Msce.wucLeftOptions.SendMessage(msgData, SendMessage_CallBack);
}

// El retorno de "Enviar mensaje a otro usuario".
function SendMessage_CallBack(res)
{
	// Elemento textArea
	textAreaContent = document.getElementById('txtMessageContent');
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{	
			boError = true;
		}
	}
	if(boError)
	{
		textAreaContent.value =  "Ha ocurrido un error.\nNO SE HA ENVIADO EL MENSAJE.";
		res = null;
		return;
	}
	if(res.value==true)
	{
		textAreaContent.value = "Mensaje enviado correctamente.";
	}
	else
	{	
		textAreaContent.value = "NO SE HA ENVIADO EL MENSAJE.\nSe desconoce la causa.";
	}
	res = null;
}

// Para las opciones de los Recordatorios
function getCantMensajesSinLeer()
{
	ISPCFG.Msce.wucLeftOptions.getCantMensajesSinLeer(getCantMensajesSinLeer_CallBack);
	window.setTimeout('getCantMensajesSinLeer()', 30000); // 30000 es el valor correcto.
}

function getCantMensajesSinLeer_CallBack(res)
{
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{	
			boError = true;
		}
	}
	if(boError)
	{
		document.getElementById('dvMensajesSinLeer').innerHTML = "Mensajes sin leer (" + MSG_ERROR_BEGTAG + "Error" + MSG_ENDTAG + ")";
		res = null;
		return;
	}
	document.getElementById('dvMensajesSinLeer').innerHTML = "Mensajes sin leer (" + res.value + ")";
	res = null;
}

function RemindAcademico()
{
	ISPCFG.Msce.wucLeftOptions.RemindAcademico(RemindAcademico_CallBack);
	window.setTimeout('RemindAcademico()', 90000); // 90000 es el valor correcto.
}

function RemindAcademico_CallBack(res)
{
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{	
			boError = true;
		}
	}
	if(boError)
	{
		document.getElementById('dvRegistroPendiente').innerHTML = "Solicitudes de registro (" + MSG_ERROR_BEGTAG + "Error" + MSG_ENDTAG + ")";
		document.getElementById('dvTemaProyectoPendiente').innerHTML = "Solicitando tema de proy. (" + MSG_ERROR_BEGTAG + "Error" + MSG_ENDTAG + ")";
		res=null;
		return;
	}

	if(res.value[0]>0)
	{
		document.getElementById('dvRegistroPendiente').innerHTML = "<a href=\"revisar_solicitud_registro.aspx\">Solicitudes de registro (" + res.value[0] + ")</a>";
	}
	else
	{
		document.getElementById('dvRegistroPendiente').innerHTML = "Solicitudes de registro (" + res.value[0] + ")";
	}
	
	//alert(res.value[0]);
	//document.getElementById('dvRegistroPendiente').style.display = 'block';
	
	document.getElementById('dvTemaProyectoPendiente').innerHTML = "<a href=\"revisar_tema_proyecto.aspx\">Solicitando tema de proy. (" + res.value[1] + ")</a>";
	res=null;
}

function RemindDocente()
{
	ISPCFG.Msce.wucLeftOptions.RemindDocente(RemindDocente_CallBack);
	window.setTimeout('RemindDocente()', 90000); // 90000 es el valor correcto.
}

function RemindDocente_CallBack(res)
{
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{	
			boError = true;
		}
	}
	if(boError)
	{
		document.getElementById('dvConsultasSinRespuesta').innerHTML = "Consultas por responder (" + MSG_ERROR_BEGTAG + "Error" + MSG_ENDTAG + ")";
		res=null;
		return;
	}
	if(res.value>0)
	{
		document.getElementById('dvConsultasSinRespuesta').innerHTML = "<a href=\"responder_consultas.aspx\">Consultas por responder (" + res.value + ")</a>";
	}
	else
	{
		document.getElementById('dvConsultasSinRespuesta').innerHTML = "Consultas por responder (" + res.value + ")";
	}
	res=null;
}

function RemindMaestrante()
{
	ISPCFG.Msce.wucLeftOptions.RemindMaestrante(RemindMaestrante_CallBack);
	window.setTimeout('RemindMaestrante()', 90000); // 90000 es el valor correcto.
}

function RemindMaestrante_CallBack(res)
{
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{	
			boError = true;
		}
	}
	if(boError)
	{
		document.getElementById('dvConsultasRespondidas').innerHTML = "Consultas respondidas (" + MSG_ERROR_BEGTAG + "Error" + MSG_ENDTAG + ")";
		res=null;
		return;
	}
	if(res.value==0)
	{
		document.getElementById('dvConsultasRespondidas').innerHTML = "Consultas respondidas (" + res.value + ")";
	}
	else
	{
		document.getElementById('dvConsultasRespondidas').innerHTML = "<a href=\"consultar.aspx\" target=\"_self\">Consultas respondidas (" + res.value + ")</a>";
	}
	res = null;
}

// Este es un método Ajax, recuerda moverlo a donde corresponde en la página.
function getNextMessage()
{
	if(document.getElementById('dvMensajesSinLeer').innerHTML.indexOf('(0)')>-1)
	{
		WarningNoMoreMessage();		
		return;
	}
	// Elemento DIV (header del visor)
	document.getElementById('dvMessageViewerHeader').innerHTML = "Por favor, espere...";
	ISPCFG.Msce.wucLeftOptions.getNextMessage(getNextMessage_CallBack);
}

/* 
	En res debe venir un array de string con los siguientes datos:
	res.value[0] = Nombre del usuario que envió el usuario.
	res.value[1] = Fecha en que se envíó el mensaje.
	res.value[2] = Contenido del mensaje.
*/
function getNextMessage_CallBack(res)
{
	// Elemento DIV (header del visor)
	divMessageViewerHeader = document.getElementById('dvMessageViewerHeader')
	var boError = false;
	if(res==null)
	{
		boError = true;
	}
	if(!boError)
	{
		if(res.error!=null)
		{
			boError = true;
		}
	}
	if(!boError)
	{
		if(res.value==null)
		{	
			boError = true;
		}
	}
	if(boError)
	{
		divMessageViewerHeader.innerHTML = MSG_ERROR_BEGTAG + "(Error)" + MSG_ENDTAG;
		// Elemento <div> para el contenido del mensaje.
		document.getElementById('dvMessageViewerBody').innerHTML = MSG_ERROR_BEGTAG + "Error mientras se recuperaba el siguiente mensaje." + MSG_ENDTAG;
		res=null;
		return;
	}
	if(res.value[0]!='')
	{
		// Elemento DIV (header del visor)
		divMessageViewerHeader.innerHTML = "De: " + res.value[0] + "<br>Fecha: " + res.value[1];
		// Elemento <div> para el contenido del mensaje.
		document.getElementById('dvMessageViewerBody').innerHTML = res.value[2];
		// Mandar a ejecutar el método que actualice la cantidad de mensajes pendientes.
		getCantMensajesSinLeer();
		if(document.getElementById('dvMensajesSinLeer').innerHTML.indexOf('(0)')>-1)
		{
			document.getElementById('lnkNext').style.display='none';
		}
	}
	else
	{
		WarningNoMoreMessage();
	}
}

//-->
</script>

</td>
								<td> <!-- MAIN WINDOW; BEGIN -->
									<table id="Table19" cellspacing="0" cellpadding="0" width="545" border="0">
										<tr valign="top">
											<td id="td_bodyHeader" style="PADDING-RIGHT: 30px; PADDING-LEFT: 30px" valign="middle"
												align="center" width="545" height="65">
												<span class="subtit_A" id="spHeaderContent">MI MALETÍN </span>
											</td>
										</tr>
										<tr valign="top">
											<td>
												<table id="Table20" cellspacing="0" cellpadding="0" width="100%" border="0">
													<tr>
														<td id="td_body_bg" valign="top" align="center" height="320" width="100%" style="PADDING-RIGHT: 15px; PADDING-LEFT: 15px">
															<!-- TABLA PARA LA INFORMACIÓN DE LA QUOTA ASIGNADA Y UTILIZADA -->
															<table id="tbl_Info" width="100%" style="DISPLAY: block" border="0">
																<tr valign="bottom">
																	<td align="left" class="normalTextInfo_A" width="100%">
																		<label><b>Quota:</b></label>&nbsp;<span id="spEspacioPermitido"></span>&nbsp;&nbsp;
																		<label><b>Espacio utilizado:</b></label>&nbsp;<span id="spEspacioOcupado"></span>
																	</td>
																	<!-- Fondo: #ffffcc Bordes: #330099 Verde: #66cc00 Azul: #415884 Rojo: #ff0033 -->
																	<td align="left" width="152">
																		<label id="lblTextoPorciento" class="tinyTextInfo_A"></label>
																		<br>
																		<span id="dvWrapperPorciento" style="BORDER-RIGHT: #330099 1px solid; BORDER-TOP: #330099 1px solid; DISPLAY: block; BORDER-LEFT: #330099 1px solid; WIDTH: 152px; BORDER-BOTTOM: #330099 1px solid; HEIGHT: 5px; BACKGROUND-COLOR: #ffffcc; TEXT-ALIGN: left">
																			<span id="dvImagenPorciento" style="DISPLAY: block; MARGIN: 1px; WIDTH: 0px; HEIGHT: 3px; BACKGROUND-COLOR: #ff6666; TEXT-ALIGN: left">
																			</span></span>
																	</td>
																</tr>
																<tr valign="top">
																	<td colspan="2" height="1" width="100%">
																		<hr width="100%" color="#47639a" size="1">
																		</hr>
																	</td>
																</tr>
															</table>
															<!-- TABLA PARA RENOMBRAR FICHERO -->
															<table id="tbl_Renombrar" style="DISPLAY: none" width="100%" align="center" border="0">
																<!-- txtNombreActual -->
																<tr valign="middle">
																	<td align="left" colspan="2" width="510">
																		<span class="normalTextInfo_A"><b>Cambiar nombre del fichero seleccionado</b></span>
																	</td>
																</tr>
																<tr valign="middle">
																	<td align="left" nowrap>
																		<label for="txtNombreActual">Nombre actual del fichero:</label>
																	</td>
																	<td align="left">
																		<input class="frmTextInput_disabled" id="txtNombreActual" size="35" maxlength="50" type="text"
																			readonly NAME="txtNombreActual">
																	</td>
																</tr>
																<!-- txtNuevoNombre -->
																<tr valign="middle">
																	<td align="left" nowrap>
																		<label for="txtNuevoNombre">Nuevo nombre propuesto:</label>
																	</td>
																	<td align="left">
																		<input class="frmTextInput" id="txtNuevoNombre" size="35" maxlength="50" type="text" NAME="txtNuevoNombre"><span id="spValNuevoNombre" class="spErrorNotification" style="WIDTH: 100%"></span>
																	</td>
																</tr>
																<!-- Separador -->
																<tr valign="top">
																	<td colspan="2" height="1">
																		<hr width="100%" color="#47639a" size="1">
																		</hr>
																	</td>
																</tr>
															</table>
															<!-- TABLA PARA AGREGAR NUEVOS FICHEROS AL MALETÍN -->
															<table id="tbl_Nuevo" style="DISPLAY: none" width="100%" align="center" border="0">
																<tr valign="middle">
																	<td align="left" width="510" colspan="2">
																		<span class="normalTextInfo_A"><b>Agregar nuevos ficheros a mi maletín</b></span>
																	</td>
																</tr>
																<!-- TR para incrustar los elementos para la selección de ficheros para hacer uploads -->
																<tr valign="top">
																	<td align="left">
																		<div id="dvWrapperFileBrowser"><input name="element_input" id="element_input" type="file" class="frmTextInput" size="50" /><br>
																			<div id="files_list" style="BORDER-RIGHT: black 1px solid; PADDING-RIGHT: 5px; BORDER-TOP: black 1px solid; PADDING-LEFT: 5px; FONT-SIZE: 7pt; BACKGROUND: #fff; PADDING-BOTTOM: 5px; BORDER-LEFT: black 1px solid; PADDING-TOP: 5px; BORDER-BOTTOM: black 1px solid">
																				<div id="files_list_header">Files (maximum X):</div>
																			</div>
																		</div>
																		<script src="includes/multifile.js"></script>
																	</td>
																</tr>
																<!-- Separador -->
																<tr valign="top">
																	<td height="1" width="100%">
																		<hr width="100%" color="#47639a" size="1">
																		</hr>
																	</td>
																</tr>
															</table>
															<!-- TABLA PARA LOS BOTONES Y LA LISTA DE LOS MÓDULOS -->
															<table id="tbl_List" width="100%" align="center" border="0">
																<tr valign="top">
																	<td align="left">
																		<span id="spEstadoActualizacion" style="COLOR: #47639a; TEXT-ALIGN: left"></span>
																	</td>
																	<td align="right" nowrap>
																		<a id="lnkNuevo" title="Agregar un nuevo módulo." href="JavaScript:Nuevo();"><img id="imgNuevo" title="Agregar un nuevo módulo." alt="Nuevo" src="imagenes/btn_nuevo.gif"
																				border="0"></a> <a id="lnkActualizar" title="Actualizar modificación." href="JavaScript:Actualizar();">
																			&nbsp;<img title="Actualizar modificación." alt="Actualizar" src="imagenes/btn_actualizar.gif"
																				border="0"></a> <a id="lnkCancelar" title="Cancelar" href="JavaScript:Cancelar();">
																			&nbsp;<img id="imgCancelar" title="Cancelar" alt="Cancelar" src="imagenes/btn_cancelar.gif"
																				border="0"></a>
																	</td>
																</tr>
																<tr valign="top">
																	<td colspan="2" height="1">
																		<hr width="100%" color="#47639a" size="1">
																		</hr>
																	</td>
																</tr>
																<tr valign="top">
																	<td colspan="2">
																		<!-- ELEMENTO DIV PARA LLENARLO CON LA TABLA DE LA LISTA DE LOS FICHEROS EN EL MALETÍN -->
																		<div id="dvLista"></div>
																	</td>
																</tr>
															</table>
														</td>
													</tr>
												</table>
											</td>
										</tr>
									</table>
									<!-- MAIN WINDOW; END --></td>
							</tr>
						</table>
						<!-- BODY TABLE; END --></td>
				</tr>
			</table>
		<script language='JavaScript'><!--
	var SessionTime = 60;
	function SessionTimeout()
	{
		SessionTime -= 1;
		document.getElementById('spSessionTimeout').innerHTML = 'Tiempo restante: ' + SessionTime + ' min';
		if(SessionTime <= 0)
		{
			ForceToCloseSession();
		}
		window.setTimeout('SessionTimeout()', 60000)
	}
	SessionTimeout();
//--></script>


	<script language='JavaScript'><!--
getUsersList();
getCantLoggedUsers();//--></script>


	<script language='JavaScript'><!--
document.getElementById('spSearchBibliografias').style.display='block';
document.getElementById('spSearchConsultas').style.display='block';
//--></script>


	<script language='JavaScript'><!--
getCantMensajesSinLeer();
//--></script>


	<script language='JavaScript'><!--
document.getElementById('dvConsultasRespondidas').style.display='block';
RemindMaestrante();
//--></script>


</form> <!-- PAGE TABLE; END -->
		<script language="javascript">
		<!--

		/* 
			PARA LA DECLARACIÓN DE LAS IMÁGENES DE FONDO DE LAS CELDAS, LO HACEMOS POR SCRIPT
			PORQUE FireFox NO INTREPRETA BIEN LO QUE NECESITAMOS SI UTILIZAMOS ESTILOS.
		*/
		document.getElementById('td_body_bg').style.backgroundImage = "url(imagenes/body_bg.gif)";
		document.getElementById('td_body_bg').style.backgroundRepeat = "no-repeat";
		document.getElementById('td_navBarLeft').style.backgroundImage = "url(imagenes/side_nav_bg.gif)";
		document.getElementById('td_navBarLeft').style.backgroundRepeat = "no-repeat";
		document.getElementById('td_bodyHeader').style.backgroundImage = "url(imagenes/body_header.gif)";
		document.getElementById('td_bodyHeader').style.backgroundRepeat = "no-repeat";
		
		var settings = {"Modo": 'Listar', "allowNewUploads": true, "IdEditado": null};
		
		function getMiMaletin()
		{
			settings.Modo = 'Listar';
			switchView();
			ISPCFG.Msce.clswfMiMaletin.getMiMaletin(getMiMaletin_CallBack);
		}
		function getMiMaletin_CallBack(res)
		{
			var boError = false;
			if(res.error!=null)
			{
				boError = true;
			}
			else
			{
				if (res.value == null || typeof(res.value) != "object")
				{
					boError = true;
				}
			}
			if(boError==true)
			{
				trNotify = document.getElementById('tr_Notify');
				spNotify = document.getElementById('sp_Notify');
				ProcessPageError(trNotify, spNotify, "Imposible recuperar la lista de los elementos de su perfil.");
				res=null;
				return false;
			}
				
			MiMaletin = res.value;  
			document.getElementById('spEspacioPermitido').innerHTML = parseInt(parseInt(MiMaletin.BriefcaseMaxSizeAllowed)/1024) + " KB";
			document.getElementById('spEspacioOcupado').innerHTML = parseInt(parseInt(MiMaletin.EspacioOcupado)/1024) + " KB";
			// Azul: #415884 Verde: #66cc00 Rojo: #ff0033
			// Entre 0 y 50 mostrar la barra de porciento de color azul.
			if(parseInt(MiMaletin.PorcientoOcupado)<=50){document.getElementById('dvImagenPorciento').style.backgroundColor = "#415884";}
			// Entre 51 y 80 mostrar la barra de porciento de color verde.
			if(parseInt(MiMaletin.PorcientoOcupado)>50 & parseInt(MiMaletin.PorcientoOcupado)<=80){document.getElementById('dvImagenPorciento').style.backgroundColor = "#66cc00";}
			// Mayor que 80 mostrar la barra de porciento de color rojo.
			if(parseInt(MiMaletin.PorcientoOcupado)>80){document.getElementById('dvImagenPorciento').style.backgroundColor = "#ff0033";}
			// Definir el ancho de la barra que indica el porciento de manera gráfica.
			document.getElementById('dvImagenPorciento').style.width = parseInt(parseFloat(MiMaletin.PorcientoOcupado)*1.5)<=150?parseInt(parseFloat(MiMaletin.PorcientoOcupado)*1.5):150;
			document.getElementById('lblTextoPorciento').innerHTML = parseFloat(MiMaletin.PorcientoOcupado) + " % utilizado";
			
			// Establecer la variable que indica si se permiten nuevos uploads.
			settings.allowNewUploads = MiMaletin.PorcientoOcupado<100.00;

			var strHTML = "<table border=\"0\" width=\"100%\">\n";
					strHTML += "\t<tr valign=\"bottom\">\n";
					strHTML += "\t\t<td align=\"left\" width=\"20%\" nowrap><b>Acciones</b></td>\n";
					strHTML += "\t\t<td align=\"left\" width=\"50%\" nowrap><b>Nombre</b></td>\n";
					strHTML += "\t\t<td align=\"left\" width=\"10%\"><b>Tamaño (bytes)</b></td>\n";
					strHTML += "\t\t<td align=\"left\" width=\"20%\"><b>Ultima modificacion</b></td>\n";
					strHTML += "\t</tr>\n";

			for(i=0; i<=(MiMaletin.Contenido.length-1); i++)
			{
				var Id = MiMaletin.Contenido[i].Id;
				var Nombre = MiMaletin.Contenido[i].Nombre;
				var Size = MiMaletin.Contenido[i].Size;
				var Fecha = MiMaletin.Contenido[i].FechaUltimaModificacion;
				// Formar el cuerpo del registro actual.
				//strHTML += "\t<!-- TABLA PARA DAR FORMATO A UN REGISTRO -->\n";
				strHTML += "\t<tr id=\"trFile" + Id + "\" valign=\"top\">\n";
				strHTML += "\t\t<td width=\"20%\"><a style=\"text-Decoration: underline\" href=\"JavaScript:Renombrar(" + Id + ", '" + Nombre + "');\">Renombrar</a>&nbsp;<a style=\"text-Decoration: underline\" href=\"JavaScript:Eliminar('" + Nombre + "');\">Eliminar</a>&nbsp;</td>\n";
				strHTML += "\t\t<td width=\"30%\" id=\"Nombre" + Id + "\"><a href=\"JavaScript:download(this, '" + Nombre + "');\">" + Nombre + "</a></td>\n";
				strHTML += "\t\t<td width=\"20%\" id=\"Size" + Id + "\">" + Size + "</td>\n";
				strHTML += "\t\t<td width=\"30%\" id=\"Fecha" + Id + "\">" + getStringFromDate(Fecha) + "</td>\n";
				strHTML += "\t</tr>\n";
			}
			
			strHTML += "\t<tr id=\"trFoot\" valign=\"bottom\">\n";
			strHTML += "\t\t<td colspan=\"4\"><b>Total de ficheros:</b> " + MiMaletin.CantTotalFiles + "</td>\n";
			strHTML += "\t</tr>\n";
			strHTML += "</table>\n";
				
			document.getElementById("dvLista").innerHTML = strHTML;	
			// Ejecutar la función setButtomsVisibility(), aunque esta se ejecuta en switchView(), 
			// para que se tenga en cuenta si se ha deshabilitado la posibilidad de hacer nuevos uploads.
			setButtomsVisibility();
			
		}

		function Nuevo()
		{
			// Limpiar el área de notificación de errores.
			ClearPageAnyNotification(document.getElementById('tr_Notify'), document.getElementById('sp_Notify'));
			// Limpiar el área de notificación de actualización.
			document.getElementById('spEstadoActualizacion').innerHTML = "";

			settings.Modo = "Nuevo";
			switchView();
			document.getElementById('element_input').focus();
			return;
		}

		function Renombrar(id, nombre)
		{
			// Limpiar el área de notificación de errores.
			ClearPageAnyNotification(document.getElementById('tr_Notify'), document.getElementById('sp_Notify'));
			// Limpiar el área de notificación de actualización.
			document.getElementById('spEstadoActualizacion').innerHTML = "";

			/* Para cuando se está cambiando un nombre de fichero y 
				 se selecciona cambiar el nombre a otro, sin utilizar cancelar.
			*/
			if(settings.Modo=='Renombrar' & settings.IdEditado!=null)
			{
				// Si existe el TR, entonces mostrarlo porque debe estar oculto.
				if(document.getElementById('trFile'+settings.IdEditado)!=undefined){document.getElementById('trFile'+settings.IdEditado).style.display='';}
			}
			settings.Modo = 'Renombrar';
			settings.IdEditado = id;
			switchView();
			document.getElementById('trFile'+settings.IdEditado).style.display = 'none';
			document.getElementById('txtNombreActual').value = nombre;
			document.getElementById('txtNuevoNombre').value = nombre;
			document.getElementById('txtNuevoNombre').focus();
		}

		function Actualizar()
		{
			// Limpiar el área de notificación de errores.
			ClearPageAnyNotification(document.getElementById('tr_Notify'), document.getElementById('sp_Notify'));

			switch(settings.Modo)
			{
				case 'Renombrar':
				{
					if(document.getElementById('txtNombreActual').value==document.getElementById('txtNuevoNombre').value){return;}

					//alert("Renombrando");
					if(!valNuevoNombre())
					{
						document.getElementById('txtNombreActual').focus();
						//alert("No es válido");
						return;
					}
					document.getElementById('spEstadoActualizacion').innerHTML = "Cambiando nombre. Por favor, espere...";
					var ActualNombre = document.getElementById('txtNombreActual').value;
					var NuevoNombre = document.getElementById('txtNuevoNombre').value;
					ISPCFG.Msce.clswfMiMaletin.Renombrar(ActualNombre, NuevoNombre, Renombrar_CallBack);
					break;
				}
				case 'Nuevo':
				{
					// Comprobar si no hay ficheros en la lista 'files_list' y tampoco en el control 'element_input'
					if((document.getElementById('files_list').childNodes.length==1) & (document.getElementById('element_input').value=="")){return;};

					// Si se establece el valor de la propiedad 'file_patern' del objeto 'files_Selector', 
					// entonces comprobar que cumpla con dicha regla el nombre del fichero que se indica en 
					// dicho control ala hora de la actualización, si es que no está en balnco el mismo.
					if(files_Selector.file_patern!=null)
					{
						var element = document.getElementById('element_input');
						var i = element.value.lastIndexOf("\\"); // Para Windows
						if(i==-1){i = element.value.lastIndexOf("/");} // Para Linux
						var fileName = element.value.substring(eval(i+1), element.value.length); 
						var regExp = new RegExp(files_Selector.file_patern);
						if(!fileName.match(regExp))
						{
							alert("El nombre de fichero: \"" + fileName + "\" no es válido.");
							element.focus();
							return;
						}
					}
					document.forms["frm_MiMaletin"].submit();
					break;
				}
				default:
				{
					return;
				}
			}
			settings.Modo = "Listar";
			getMiMaletin();
			return;
		}
		function Renombrar_CallBack(res)
		{
			var boError = false;
			if(res.error!=null)
			{
				boError = true;
			}
			else
			{
				if (res.value == null)
				{
					boError = true;
				}
			}
			if(boError==true)
			{
				// Limpiar el área de notificación de actualización.
				document.getElementById('spEstadoActualizacion').innerHTML = "";
				trNotify = document.getElementById('tr_Notify');
				spNotify = document.getElementById('sp_Notify');
				ProcessPageError(trNotify, spNotify, "Imposible cambiar el nombre del fichero como se solicitó porque ha sucedido un error.");
				res=null;
				return false;
			}

			if(res.value==false)
			{
				// Limpiar el área de notificación de actualización.
				document.getElementById('spEstadoActualizacion').innerHTML = "";
				trNotify = document.getElementById('tr_Notify');
				spNotify = document.getElementById('sp_Notify');
				ProcessPageError(trNotify, spNotify, "Imposible cambiar el nombre del fichero como se solicitó, sin embargo, no se ha reportado ningún error.");
				res=null;
				return false;
			}
			else
			{
				document.getElementById('spEstadoActualizacion').innerHTML = "Actualización efectuada";
				return true;
			}
		}

		function Eliminar(strFileName)
		{
			// Limpiar el área de notificación de errores.
			ClearPageAnyNotification(document.getElementById('tr_Notify'), document.getElementById('sp_Notify'));
			
			if(!window.confirm("Eliminará de manera permanente el fichero '" + strFileName + "'")){return;}
			document.getElementById('spEstadoActualizacion').innerHTML = "Eliminando fichero. Por favor, espere...";
			ISPCFG.Msce.clswfMiMaletin.Eliminar(strFileName, Eliminar_CallBack);
		}
		function Eliminar_CallBack(res)
		{
			var boError = false;
			if(res.error!=null)
			{
				boError = true;
			}
			else
			{
				if (res.value == null)
				{
					boError = true;
				}
			}
			if(boError==true)
			{
				trNotify = document.getElementById('tr_Notify');
				spNotify = document.getElementById('sp_Notify');
				ProcessPageError(trNotify, spNotify, "Imposible eliminar el fichero como se solicitó porque ha sucedido un error.");
				document.getElementById('spEstadoActualizacion').innerHTML = "";
				res=null;
				return;
			}

			if(res.value==false)
			{
				trNotify = document.getElementById('tr_Notify');
				spNotify = document.getElementById('sp_Notify');
				ProcessPageError(trNotify, spNotify, "Imposible eliminar el fichero como se solicitó, sin embargo, no se ha reportado ningún error.");
				document.getElementById('spEstadoActualizacion').innerHTML = "";
				res=null;
				return;
			}
			else
			{
				res = null;
				getMiMaletin();
				document.getElementById('spEstadoActualizacion').innerHTML = "Fichero eliminado.";
			}
		}
		
		function Cancelar()
		{
			// Limpiar el área de notificación de errores.
			ClearPageAnyNotification(document.getElementById('tr_Notify'), document.getElementById('sp_Notify'));
			// Limpiar el mensaje en la parte izquierda de los botones.
			document.getElementById('spEstadoActualizacion').innerHTML = "";

			switch(settings.Modo)
			{
				case 'Nuevo':
				{
					files_Selector.clearFileSelection();
					break;
				}
				case 'Renombrar':
				{
					document.getElementById('trFile'+settings.IdEditado).style.display='';
					settings.IdEditado = null;
					break;
				}
			}

			settings.Modo = "Listar";
			getMiMaletin();
			return;
		}

		function download(objLink strFileName)
		{
			alert(document.location + "?downloadFile=" + strFileName);
			//objLink.href = document.location + "?downloadFile=" + strFileName;
			
			//alert("Esta función no se ha implementado aún...");
			//return;

			//ISPCFG.Msce.clswfMiMaletin.Download(strFileName, download_CallBack); 
		}
		function download_CallBack(res)
		{
			//alert('OK');
			if(res.error!=null)
			{
				alert("Mensaje de error: " + res.error.Message);
				return;
			}
			
			alert(res.value);
		}
		
		/*
			VALIDACIONES
		*/
		// Esta se encuentra en "main.js"
		// function valEmptyString(sender, objMessageLabel, strMessage)
		
		// Valida todo el documento apoyándose en las funciones 
		// específicas para cada uno de los controles.
		function valNuevosUploads()
		{
			return false;
		}

		function valNuevoNombre()
		{
			if(!valEmptyString(document.getElementById('txtNuevoNombre'), document.getElementById('spValNuevoNombre'), "El campo \"Nuevo nombre\" no puede estar vacío.")){return false;}
			if(!valByPatern(document.getElementById('txtNuevoNombre'), BRIEFCASE_FILENAME_PATERN))
			{
				document.getElementById('spValNuevoNombre').innerHTML = "Revise el nombre del fichero, sólo se admiten los caracteres: a-z; A-Z; 0-9 y subreyado (_), además de lo establecido para la extensión.";
				document.getElementById('spValNuevoNombre').style.display='block';
				return false;
			}
			document.getElementById('spEstadoActualizacion').innerHTML = "Comprobando nombre del fichero...";
			var res = ISPCFG.Msce.clswfMiMaletin.existFile(document.getElementById('txtNuevoNombre').value).value;
			if(res.error!=null)
			{
				trNotify = document.getElementById('tr_Notify');
				spNotify = document.getElementById('sp_Notify');
				ProcessPageError(trNotify, spNotify, "Imposible comprobar si ya existe el nombre del fichero, ha sucedido un error, si el problema persiste consulte a los administradores del sistema.");
				res=null;
				return false;
			}			
			if(res==true)
			{
				document.getElementById('spValNuevoNombre').innerHTML = "El nombre del fichero que propone ya se utiliza por parte de otro fichero, elija otro nombre.";
				document.getElementById('spValNuevoNombre').style.display='block';
				res=null;
				return false;
			}			

			return true;
		}
		
		function switchView()
		{
			// Referencias a las tablas
			var table_Info = document.getElementById('tbl_Info');
			var table_List = document.getElementById('tbl_List');
			var table_Nuevo = document.getElementById('tbl_Nuevo');
			var table_Renombrar = document.getElementById('tbl_Renombrar');

			// Las tablas para información y para la 
			// lista de ficheros siemre estarán visibles.
			table_Info.style.display = 'block';
			table_List.style.display = 'block';
			
			switch(settings.Modo)
			{
				case 'Listar':
				{
					table_Nuevo.style.display = 'none';
					table_Renombrar.style.display = 'none';
					break;
				}
				case 'Nuevo':
				{
					table_Nuevo.style.display = 'block';
					table_Renombrar.style.display = 'none';
					break;
				}
				case 'Renombrar':
				{
					table_Renombrar.style.display = 'block';
					table_Nuevo.style.display = 'none';
					break;
				}
				// Para cuando no existan Sedes y/o Menciones registradas, este webForm no es válido.
				case 'Disabled':
				{
					table_Info.style.display = 'block';
					table_Renombrar.style.display = 'none';
					table_List.style.display = 'none';
					table_Nuevo.style.display = 'none';
					break;
				}
			}
			
			setButtomsVisibility();
			
		}

		function setButtomsVisibility()
		{
			var btnNuevo = document.getElementById('lnkNuevo');
			var btnActualizar = document.getElementById('lnkActualizar');
			var btnCancelar = document.getElementById('lnkCancelar');
			
			switch(settings.Modo)
			{
				case 'Nuevo':
				case 'Renombrar':
				{
					btnNuevo.style.display='none';
					btnActualizar.style.display='inline';
					btnCancelar.style.display='inline';
					break;
				}
				// Para cuando no existan Sedes y/o Menciones registradas, este webForm no es válido.
				case 'Disabled':
				{
					btnNuevo.style.display='none';
					btnActualizar.style.display='none';
					btnCancelar.style.display='none';
					break;
				}
				// default es igual a 'Lista'
				default:
				{
					btnNuevo.style.display='inline';
					btnActualizar.style.display='none';
					btnCancelar.style.display='none';
				}
			}
			
			// Establecer las opciones para el botón "Nuevo" según la propiedad "settings.allowNewUploads"
			if(settings.allowNewUploads==false)
			{
				btnNuevo.style.display='none';
				document.getElementById('spEstadoActualizacion').innerHTML = "<b>SU MALETÍN ESTÁ LLENO, NO PODRÁ AGREGAR NUEVOS FICHEROS</b>";
			}
		}

		function disableForm()
		{
			alert("Deshabilitar webForm");
		}


		/*
			INICIALIZAR ESTE WEBFORM.
		*/
		// Asignar al objeto para los "INPUT FILE" múltiples el PATERN correspondiente 
		// al formato de los nombres de ficheros para los maletines que se encuentra en 
		// el fichero main.js
		files_Selector.file_patern = BRIEFCASE_FILENAME_PATERN;
		// Leer los ficheros que se encuentran en el maletín del usuario actual.
		getMiMaletin();

		//-->
		
		</script>
	</body>
</html>
